diskutil umount force /Users/gvandova/TargetMining/
sshfs gvandova@maguro.stanford.edu:/mnt/gnpn/gnpn/projects/orphanpks/TargetMining/ /Users/gvandova/TargetMining/

COEVOLUTION STEP

Jan-10-2019

1. mkdir Coevolution
2. Make fasta files with all KS and target sequences

   cat seq_dir/sequences.faa.21k.coord.fasta seq_dir/sequences.faa.89k.coord.fasta > sequences.110k.coord.redundant.fasta

Jan-11-2019
   ./get_ks_sequences.py

3. separate fasta files into separate sequence files for blasting
  mv *.fasta target_seq/
  mv *.KS.fasta KS_seq/
  cat *.fasta > all.KS.fasta
  cat *.fasta > all.target.fasta

  ./split_fastaseqs.py

  mkdir KS_split
  mv *.KS.* KS_split/
  mkdir target_split
  mv *.fasta target_split/

4. Make blast databases for KS and targets
  ./makeblastdb.py
   mv antismashdb_* blastdb/


Jan-14-2019
5. Run paiwise blast
./run_blast.py

WOrking but I don't know which KS comes with which target, since their coord are diff.
Add cluster coord to sequence ids.

Start from beginning of pipeline:
1. Make fasta files of all KS and corresponding target sequences:
    ./get_ks_sequences.py
    Ouptut ids:
    >[target].[clusterid].[clustercoord].[targetcoord] for all target sequences
    >[target].[clusterid].[clustercoord].KS. [targetcoord] for all KS sequences
    >borI_Thr-tRNA-syn.QZFT01000045.122581-166774.137802-139817
    >borI_Thr-tRNA-syn.QZFT01000045.122581-166774.KS.142614-143975

    mv *.fasta fasta_seqs/

2. Run ./makeblastb.py and move to blastdb/

Jan-15-2019
3. Run pairwise blast
  ./run_blastp.py
  evalue cutoff = 1e-8
  mv out/*.KS.out ks_seqs/
  cat ks_seqs/* > all.KS.out
  cat *.out > all.targets.out
  mv ks_seqs/* out/

  cat borI_Thr-tRNA-syn.out |wc
       81     648   11320
  cat borI_Thr-tRNA-syn.KS.out |wc
       71     568   10254

Jan-16-2019
4. Extract ks and corresponding target pairwise identities
  ./parse_pairwise_identities.py

  cat all.KS.out | grep borI_Thr-tRNA-syn.QZFT01000045 | grep borI_Thr-tRNA-syn.LGTC01000001
  borI_Thr-tRNA-syn.LGTC01000001.2624321-2672198.KS.2647729-2648562	borI_Thr-tRNA-syn.QZFT01000045.122581-166774.KS.142614-143975	206	303	28	278	454	4e-04
  borI_Thr-tRNA-syn.QZFT01000045.122581-166774.KS.142614-143975	borI_Thr-tRNA-syn.LGTC01000001.2624321-2672198.KS.2647729-2648562	21	127	28	454	278	6e-04

  borI_Thr-tRNA-syn.QZFT01000045-borI_Thr-tRNA-syn.LGTC01000001	6.17	borI_Thr-tRNA-syn.QZFT01000045-borI_Thr-tRNA-syn.LGTC01000001	35.62

manual blast: 35% KS seq identity
in fasta_seqs/borI_Thr-tRNA-syn.KS.fasta
>borI_Thr-tRNA-syn.LGTC01000001.2624321-2672198.KS.2647729-2648562

  cat blast_results.KS.fasta.cleanName.cdhit.99 | grep LGTC01000001
  >LGTC01000001___1717315_1718712__2_-1_6878816_3e-67
  >LGTC01000001___1465072_1466283__2_-1_6878816_2e-22
  >LGTC01000001___225988_227286__0_1_6878816_3e-107
  >LGTC01000001___1956479_1957750__1_-1_6878816_4e-102
  >LGTC01000001___2650774_2652174__2_-1_6878816_9e-50 REAL KS
  >LGTC01000001___218710_219993__0_1_6878816_2e-88
  >LGTC01000001___2647729_2648562__2_-1_6878816_0.007 CURRENT KS

  vim sequences.faa.21k.coord.fasta
  >LGTC01000001_cluster-1_2624321-2672198_t1pks_2644321-2652198_ctg1_146_- WHOLE MODULE SEQUENCE

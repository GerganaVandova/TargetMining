I. BLAST STEP

Location: TargetMining/Blast/ folder

Blast 8 diverse KSs from modular KS, cisat pks/nrps and transat pks/nrps hybrids
against 11 databases (wgs not updated)
and parse blast results with e value < 1

    The blast queries are in Manual/

    1. Make phylogenetic tree of all typeI ks sequences used to make HMMs (27)
    2. make a phylogenetic tree in clustal omega
    3. pick diverse sequences to Blast
    4. update 11 databases (wgs not updated since 2013)
       cd /mnt/gnpn/gnpn/projects/orphanpks/blast/db/
       perl update_blastdb.pl --passive [database]

1. Run ./run_blast.py (specify on line 49 which query sequences to blast against)
If you want to run blast agains all sequences, type
blast_query_files = glob.glob("%s/*.seq" % blast_query_dir)

2. Run make all

    All files stored in TargetMining/Blast/blast_results_seqs/ folder

    2.1 Concatenate all parsed blast files into one: make concat
    creates blast_results_seqs/blast_results.parsed.KS.9f

    2.2 Uniqify the proteins and remove dashes and asterisks and choose longest
    synonym: make longest (have to rm output files of Step #2.4)
    creates blast_results.parsed.KS.9f.synonyms
            blast_results.parsed.KS.9f.longest_synonym

    2.3. Compare the Reference set to the found set: make compare
    creates blast_results.parsed.KS.9f.longest_synonym.comparemibig

    2.4.  Make fasta file of blast hit sequences to use in HMM search and clean the
    names: make fasta
    creates blast_results.KS.fasta
            blast_results.KS.fasta.cleanName

    2.5. Remove redundant sequences (cdhit cutoff = 0.99): make cdhit
    creates blast_results.KS.fasta.cleanName.cdhit.99
            blast_results.KS.fasta.cleanName.cdhit.99.clstr

**********************************************
STEP2. Fetch all genbank ids that contain a KS
**********************************************

1. make Genbank dir:
 mkdir GenBank
 mkdir Genbank/gbdir
 cp get_gbids.py from oldTargetMining
 cp fetch_gbids.py from oldTargetMining

2. ./get_gbid.py

 gvandova@maguro:/mnt/gnpn/gnpn/projects/orphanpks/TargetMining/Genbank$ cat gbids.txt |wc
 162984  162984 1918063

3. cat gbids.txt |sort -u > gbids.unique.txt

 gvandova@maguro:/mnt/gnpn/gnpn/projects/orphanpks/TargetMining/Genbank$ cat gbids.unique.txt |wc
 94516   94516 1141060

Run fetch_gbid.py
gvandova@maguro:/mnt/gnpn/gnpn/projects/orphanpks/TargetMining/Genbank/gbdir$ lr |wc
 94517  850646 6623003
